<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>

    <link rel="stylesheet" href="/chatstyles.css">
<style>
/* Ensure the body and navbar remain unaffected */
body {
    font-family: 'Arial', sans-serif;
    line-height: 1.6;
    color: #333;
    height: 100%;
    margin: 0;
    display: flex;
    flex-direction: column; /* Stacks the navbar and main content */
}

/* Navbar remains as is */
.navbar {
    flex: 0 0 auto; /* Prevent shrinking */
    width: 100%;    /* Full width */
}

/* Centering just the dashboards */
.dashboard-container {
    flex: 1; /* Allows it to take up remaining space */
    display: flex;
    justify-content: center; /* Centers horizontally */
    align-items: center;    /* Centers vertically */
    flex-direction: column; /* Optional: Stacks multiple dashboards */
    padding: 2rem; /* Optional: Adds breathing space */
    width: 100%;    /* Full width for responsiveness */
    margin: auto;   /* Ensures proper alignment */
}



</style>
    
</head>
<body>
    <div class="navbar">
        <ul>
            <% if (volunteer.role_name.toLowerCase() === 'admin') { %>
                <header>
                        <div class="logo">
                            <a href="/">Turtle Shelter Project</a>
                            
                        </div>
                        <ul class="nav-links">
                            <% if (volunteer.role_name.toLowerCase() === 'admin') { %>
                                <li><a href="/dashboard">Dashboard</a></li>
                                <% } else { %>
                                <li><a href="/dashboard">Event Sign Up</a></li>    
                                    <% } %>
                            <li><a href="/manageUsers">Manage Volunteers</a></li>
                            <li><a href="/manageEvents">Manage Events</a></li>
                            <li><a href="/manageRequests">Manage Requests</a></li>
                            <li><a href="/logout">Logout</a></li>
                        </ul>
                </header>
            <% } else { %>
                
                <header>
                        <div class="logo">
                            <a href="#">Turtle Shelter Project</a>
                        </div>
                        <ul class="nav-links">
                            <li><a href="/createRequest">Request an Event</a></li>
                            <li><a href="/logout">Logout</a></li>
                        </ul>
                 </header>
            <% } %>
            
        </ul>
    </div>

    <div class="main-content">
        <!-- <h1>Welcome to the Dashboard</h1>
        <p><strong>Debug Info:</strong> Your role is: <%= volunteer.role_name %></p> -->

        <% if (volunteer.role_name.toLowerCase() === 'admin') { %>
            <div class="dashboard-container" id="viz1733430860835" style="position: relative;">
                <noscript>
                    <a href="#">
                        <img alt="Management Dashboard" src="https://public.tableau.com/static/images/Tu/TurtleShelterProject_17334307953790/ManagementDashboard/1_rss.png" style="border: none" />
                    </a>
                </noscript>
                <object class="tableauViz" style="display:none;">
                    <param name="host_url" value="https://public.tableau.com/" />
                    <param name="embed_code_version" value="3" />
                    <param name="path" value="views/TurtleShelterProject_17334307953790/ManagementDashboard?:language=en-US&amp;:embed=true&amp;publish=yes&amp;:sid=&amp;:redirect=auth" />
                    <param name="toolbar" value="yes" />
                    <param name="static_image" value="https://public.tableau.com/static/images/Tu/TurtleShelterProject_17334307953790/ManagementDashboard/1.png" />
                    <param name="animate_transition" value="yes" />
                    <param name="display_static_image" value="yes" />
                    <param name="display_spinner" value="yes" />
                    <param name="display_overlay" value="yes" />
                    <param name="display_count" value="yes" />
                    <param name="language" value="en-US" />
                    <param name="filter" value="publish=yes" />
                </object>
            </div>
            
            <script type="text/javascript">
                var divElement = document.getElementById('viz1733430860835');
                var vizElement = divElement.getElementsByTagName('object')[0];
                if (divElement.offsetWidth > 800) {
                    vizElement.style.width = '1000px';
                    vizElement.style.height = '827px';
                } else if (divElement.offsetWidth > 500) {
                    vizElement.style.width = '1000px';
                    vizElement.style.height = '827px';
                } else {
                    vizElement.style.width = '100%';
                    vizElement.style.height = '977px';
                }
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
                vizElement.parentNode.insertBefore(scriptElement, vizElement);
            </script>
            
            <div class="dashboard-container" id="viz1733430934864" style="position: relative;">
                <noscript>
                    <a href="#">
                        <img alt="Product Dashboard" src="https://public.tableau.com/static/images/Tu/TurtleShelterProjectProducts/ProductDashboard/1_rss.png" style="border: none" />
                    </a>
                </noscript>
                <object class="tableauViz" style="display:none;">
                    <param name="host_url" value="https://public.tableau.com/" />
                    <param name="embed_code_version" value="3" />
                    <param name="site_root" value="" />
                    <param name="name" value="TurtleShelterProjectProducts/ProductDashboard" />
                    <param name="tabs" value="no" />
                    <param name="toolbar" value="yes" />
                    <param name="static_image" value="https://public.tableau.com/static/images/Tu/TurtleShelterProjectProducts/ProductDashboard/1.png" />
                    <param name="animate_transition" value="yes" />
                    <param name="display_static_image" value="yes" />
                    <param name="display_spinner" value="yes" />
                    <param name="display_overlay" value="yes" />
                    <param name="display_count" value="yes" />
                    <param name="language" value="en-US" />
                    <param name="filter" value="publish=yes" />
                </object>
            </div>
            
            <script type="text/javascript">
                var divElement = document.getElementById('viz1733430934864');
                var vizElement = divElement.getElementsByTagName('object')[0];
                if (divElement.offsetWidth > 800) {
                    vizElement.style.width = '1000px';
                    vizElement.style.height = '827px';
                } else if (divElement.offsetWidth > 500) {
                    vizElement.style.width = '1000px';
                    vizElement.style.height = '827px';
                } else {
                    vizElement.style.width = '100%';
                    vizElement.style.height = '977px';
                }
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
                vizElement.parentNode.insertBefore(scriptElement, vizElement);
            </script>
                    <% } else { %>
            <table>
                <thead>
                    <tr>
                        <th>Date of Event</th>
                        <th>Duration of Event</th>
                        <th>Event Type</th>
                        <th>Event Location</th>
                        <th>Estimated Participants</th>
                        <th>Volunteers Needed</th>
                        <th>Volunteers Attending</th>
                        <th>Signup</th>
                    </tr>
                </thead>
                <tbody>
                    <% for (let iCount = 0; iCount < vol_events.length; iCount++) { %>
                        <tr>
                            <td><%= new Date(vol_events[iCount].event_datetime).toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' }) %></td>
                            <td><%= vol_events[iCount].event_duration %></td> 
                            <td><%= vol_events[iCount].event_type_name %></td>
                            <td>
                                <%= vol_events[iCount].event_street_1 %>
                                <% if (vol_events[iCount].event_street_2 && vol_events[iCount].event_street_2.trim() !== "") { %> 
                                    <%= " " + vol_events[iCount].event_street_2 %>
                                <% } %>                                
                                <%= vol_events[iCount].event_city %>, <%= vol_events[iCount].event_state %>, 
                                <%= vol_events[iCount].event_zip %>
                            </td>
                            <td><%= vol_events[iCount].participants %></td>
                            <td><%= vol_events[iCount].volunteers_needed %></td>
                            <td><%= vol_events[iCount].volunteers_signed_up %></td>
                            <td>
                                <% if (vol_events[iCount].volunteers_signed_up >= vol_events[iCount].volunteers_needed) { %>
                                    <button class="center-button" disabled>Sign Up (Full)</button>
                                <% } else if (vol_events[iCount].signed_up_vol_id) { %>
                                    <!-- Show Delete button if already signed up -->
                                    <form class="center-button" action="/deleteSignup/<%= vol_events[iCount].event_id %>" method="POST" onsubmit="return confirm('Are you sure you want to remove your signup for this event?');">
                                        <button type="submit">Remove Signup</button>
                                    </form>
                                <% } else { %>
                                    <!-- Show Sign Up button if not signed up -->
                                    <form class="center-button" action="/signupEvent/<%= vol_events[iCount].event_id %>" method="POST">
                                        <button type="submit">Sign Up</button>
                                    </form>
                                <% } %>
                            </td>
                        </tr>
                    <% } %>
                </tbody>
            </table>           
        <% } %>
    </div>

    <footer id='footer' class="footer">
        <p>&copy; 2024 Turtle Shelter Project | All rights reserved | 
            <a href="mailto:turtleshelterproject@gmailcom">turtleshelterproject@gmail.com</a> |
            <a href="tel:(801) 872-3190">(801) 872-3190</a>
        </p>
    </footer>
</body>
</html>
